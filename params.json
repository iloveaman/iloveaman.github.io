{"name":"Iloveaman.GitHub.io","tagline":"","body":"# 电视端扫码登陆 \r\n### 一、电视端扫码登陆算法.\r\n### 二、电视端扫码登陆程序流程图 \r\n\r\n#  一、电视端扫码登陆算法 \r\n \r\n    1.电视端打开扫码页面，生成二维码并发送相应参数给服务器\t \r\n    2.电视端开始轮询手机端是否已经扫描成功\r\n    3.电视端轮询手机端是否同意登录\r\n    4.电视端请求服务器获取用户登录所需的参数信息执行登陆\r\n\r\n    \r\n注：本算法基于长轮询\r\n \r\n\r\n1、电视端打开扫码页面，生成二维码并发送相应参数给服务器 \r\n  ```\r\n  1.1. 接口1：发送给服务器二维码信息\r\n  1.2. 接口1提交服务器参数：\r\n      (1) 电视端设备id(uuid)\r\n      (2) 电视端类型（备课神器教师端：ROLE_LAOSHI，云课堂:ROLE_JIAZHANG）\r\n      (3) 电视端二维码生成时间戳\r\n  1.3. 接口1返回参数：\r\n      (1) 操作成功失败标志：成功则转2，否则结束\r\n  ```\r\n\r\n注：服务器生成一条中间表记录（临时的）\r\n2、电视端开始轮询手机端是否已经扫描成功            \r\n  ``` \r\n  A. 未扫：（中间表字段手机端设备id为空）\r\n      (1) 已过期：电视端提示二维码失效 \r\n      (2) 未过期：转 2\r\n  B. 已扫\r\n      (1) 已过期：（服务端通过时间戳+有效期共同决定，电视端具体操作暂定，电视端结束轮询），电视端做相应处理\r\n      (2) 未过期：转 3\r\n  ```\r\n\r\n  ```\r\n  2.1.1. 接口2：电视端开始轮询手机端是否已经扫描成功\r\n  2.1.2. 接口2提交服务器参数：\r\n      (1) 电视端设备id（uuid）\r\n  2.1.3. 服务器返回参数(可参考接口3所传参数)：\r\n      (1) 过期标志\r\n      (2) 是否已经扫描\r\n      (3) 哪台手机扫的（手机设备id）\r\n\r\n  2.2.1. 接口3：手机端扫码并发送相应参数给服务器\r\n  2.2.2. 接口3提交服务器参数：\r\n      (1) 手机端设备id\r\n      (2) 客户端类型 (备课神器家长端，备课神器教师端)\r\n      (3) 手机端扫描时间戳\r\n      (4) 所扫描的电视端二维码对应的设备uuid\r\n      (5) 用户名（yongHuMing）、密码（miMa） 、类型（leiXing），经纬度（jingDu，weiDu）\r\n  2.2.3. 接口3返回参数：\r\n      (1) 操作成功失败标志\r\n  ```\r\n\r\n注：若有其他手机扫过，则判断手机端设备id不为空，且不等于当前手机设备id，则提示“其他设备已扫描”（电视端生成的一个二维码只能有一个手机端可以去扫）\r\n\r\n3、电视端轮询手机端是否同意登录\r\n```\r\n A. 同意：\r\n      (1) 已过期：电视端提示二维码失效 ,手机端此时扫描（请求服务器有关电视二维码的信息）应提示二维码过期\r\n      (2) 未过期：电视端登陆，转 4\r\n B. 取消：\r\n      (1) 手机端关闭确认登陆页面\r\n      (2) 电视端回到初始页面\r\n```\r\n ```\r\n 3.1.1. 接口4：电视端轮询手机端是否同意\r\n 3.1.2. 接口4提交服务器参数：\r\n      (1) 电视端设备id(uuid)\r\n      (2) 手机端设备id\r\n 3.2.1. 接口4返回参数：\r\n      (1) 过期标志\r\n      (2) 是否同意\r\n\r\n 3.3.1. 接口5：手机端同意或取消接口 \r\n 3.3.2. 接口5提交服务器参数:\r\n      (1) 手机端设备id\r\n      (2) 电视端设备id（好像重复了）\r\n 3.3.3. 接口5返回参数:\r\n      (1) 同意或取消标志\r\n```\r\n    \r\n4、电视端请求服务器获取用户登录所需的参数信息执行登陆\r\n``` \r\n  4.1. 接口6：用户登录所需的参数信息\r\n  4.2. 接口6提交服务器参数:\r\n      (1) 手机端设备id\r\n      (2) 电视端设备id \r\n  4.3. 接口6返回参数:\r\n      (1) 用户登录所需的信息\r\n ```\r\n\r\n注：\r\n  1. 轮询时间：3s ; 有效期:1min\r\n  2. 二维码失效服务器端就删除此二维码\r\n  3. ROLE_JIAZHANG = 1;//家长角色\r\n     ROLE_LAOSHI = 2;//教师长角色\r\n  4. 中间表数据库字段：\r\n  5. \r\n     (1) 电视端设备id(uuid)<br>\r\n     (2) 电视端类型（备课神器教师端：ROLE_LAOSHI，云课堂:ROLE_JIAZHANG）<br>\r\n     (3) 电视端二维码生成时间戳<br>\r\n     (4) 手机端设备id<br>\r\n     (5) 手机端类型 (备课神器家长端，备课神器教师端)<br>\r\n     (6) 手机扫码时间戳<br>\r\n     (7) 用户名（yongHuMing）<br>\r\n     (8) 密码（miMa）<br> \r\n     (9) 类型（leiXing）<br>\r\n     (10) 经度（jingDu<br>\r\n     (11) 纬度（weiDu）<br>\r\n     (12) 同意或取消<br>\r\n  6. 最新更正：时间戳统一以服务器为准。\r\n\r\n# 二、电视端扫码登陆程序流程图\r\n![电视端扫码登录流程图](/images/logo.png)\r\nFormat: ![电视端扫码登录流程图](/images/logo.png)","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}